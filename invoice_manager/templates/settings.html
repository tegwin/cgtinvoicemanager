{% extends "base.html" %}

{% block content %}
<div class="page-header mb-4">
  <h2 class="mb-1">Settings</h2>
  <p class="text-muted mb-0">Configure tax, webhooks, and API access for your invoice manager.</p>
</div>

<div class="row g-4">
  <!-- General -->
  <div class="col-lg-6">
    <div class="card-dark p-3 p-md-4 h-100">
      <h5 class="mb-3">General</h5>
      <form method="post">
        <input type="hidden" name="section" value="general">

        <div class="mb-3">
          <label class="form-label small-label">Default tax rate (%)</label>
          <input type="number" step="0.01" min="0" name="default_tax_rate"
                 class="form-control"
                 value="{{ settings.default_tax_rate or 0 }}">
          <div class="form-text text-muted">
            Used when a customer is set to "use default tax".
          </div>
        </div>

        <button type="submit" class="btn btn-primary">
          Save general settings
        </button>
      </form>
    </div>
  </div>

  <!-- Webhooks + API -->
  <div class="col-lg-6">
    <div class="card-dark p-3 p-md-4 mb-4">
      <h5 class="mb-3">Webhooks</h5>
      <form method="post">
        <input type="hidden" name="section" value="webhooks">

        <div class="form-check form-switch mb-3">
          <input class="form-check-input" type="checkbox" role="switch"
                 id="outbound_webhook_enabled"
                 name="outbound_webhook_enabled"
                 {% if settings.outbound_webhook_enabled %}checked{% endif %}>
          <label class="form-check-label" for="outbound_webhook_enabled">
            Enable outbound webhook
          </label>
        </div>

        <div class="mb-3">
          <label class="form-label small-label">Webhook URL</label>
          <input type="url" name="outbound_webhook_url" class="form-control"
                 placeholder="https://example.com/webhooks/invoices"
                 value="{{ settings.outbound_webhook_url or '' }}">
          <div class="form-text text-muted">
            JSON payloads are sent on invoice + payment events.
          </div>
        </div>

        <button type="submit" class="btn btn-primary">
          Save webhook settings
        </button>
      </form>
    </div>

    <div class="card-dark p-3 p-md-4">
      <h5 class="mb-3">API &amp; access</h5>
      <p class="text-muted mb-3">
        Manage API keys and view usage examples for integrating with your own tools
        and automation (e.g. n8n, Make, Zapier).
      </p>

      <div class="d-flex flex-wrap gap-2">
        <a href="{{ url_for('api_keys_list') }}" class="btn btn-outline-light">
          <i class="fa-solid fa-key me-1"></i> Manage API keys
        </a>
        <a href="{{ url_for('api_docs') }}" class="btn btn-outline-light">
          <i class="fa-solid fa-book me-1"></i> API documentation
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
