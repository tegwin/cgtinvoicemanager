{% extends "base.html" %}

{% block content %}
<div class="page-header mb-4">
  <h2 class="mb-1">Settings</h2>
  <p class="text-muted mb-0">Global behaviour for invoices, tax and webhooks.</p>
</div>

<div class="row g-4">
  <!-- Tax & invoicing -->
  <div class="col-lg-6">
    <div class="card-dark p-3 p-md-4 mb-3">
      <h5 class="mb-3">Invoicing &amp; Tax</h5>

      <form method="post">
        <div class="mb-3">
          <label class="small-label">Default tax rate (%)</label>
          <input type="number" step="0.01" min="0" name="default_tax_rate"
                 class="form-control"
                 value="{{ settings.default_tax_rate or 0 }}">
          <div class="form-text text-muted">
            Used when a customer is set to “use default tax”. Customers can still override this.
          </div>
        </div>

        <!-- Future: global payment terms / due date behaviour could live here -->

        <hr class="my-3" style="border-color: rgba(31,41,55,0.8);">

        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-primary">
            Save settings
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Webhooks -->
  <div class="col-lg-6">
    <div class="card-dark p-3 p-md-4 mb-3">
      <h5 class="mb-3">Outbound webhooks</h5>

      <form method="post">
        <input type="hidden" name="webhook_section" value="1">

        <div class="form-check form-switch mb-3">
          <input class="form-check-input" type="checkbox" role="switch"
                 id="outbound_webhook_enabled"
                 name="outbound_webhook_enabled"
                 {% if settings.outbound_webhook_enabled %}checked{% endif %}>
          <label class="form-check-label" for="outbound_webhook_enabled">
            Enable outbound webhooks
          </label>
        </div>

        <div class="mb-3">
          <label class="small-label">Webhook URL</label>
          <input type="url" name="outbound_webhook_url"
                 class="form-control"
                 placeholder="https://example.com/webhook-endpoint"
                 value="{{ settings.outbound_webhook_url or '' }}">
          <div class="form-text text-muted">
            The app will POST JSON payloads here when invoices or payments change.
          </div>
        </div>

        <!-- NOTE: right now backend sends all events; in a later step
             we’ll add per-event toggles that these checkboxes control. -->

        <div class="mb-3">
          <label class="small-label d-block mb-2">Events (coming soon)</label>
          <div class="text-muted small">
            Currently all events are sent. In a later update these checkboxes will allow
            selecting specific events such as <code>invoice.created</code>,
            <code>invoice.updated</code> and <code>payment.recorded</code>.
          </div>
        </div>

        <hr class="my-3" style="border-color: rgba(31,41,55,0.8);">

        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-primary">
            Save webhook config
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
